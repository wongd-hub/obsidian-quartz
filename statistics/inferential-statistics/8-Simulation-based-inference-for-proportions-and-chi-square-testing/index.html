<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="#course_coursera-inferential-stats #statistics
Small sample proportions If the success-failure â‰¥ 10 rule (i.e. the Sample Size/Skew condition) is not satisfied, then the sampling distribution for your given scenario will not adhere to the CLT, reducing the effectiveness of CLT-based methods."><meta property="og:title" content="8 Simulation based inference for proportions and chi-square testing"><meta property="og:description" content="#course_coursera-inferential-stats #statistics
Small sample proportions If the success-failure â‰¥ 10 rule (i.e. the Sample Size/Skew condition) is not satisfied, then the sampling distribution for your given scenario will not adhere to the CLT, reducing the effectiveness of CLT-based methods."><meta property="og:type" content="website"><meta property="og:image" content="https://wongd-hub.github.io/obsidian-quartz/icon.png"><meta property="og:url" content="https://wongd-hub.github.io/obsidian-quartz/statistics/inferential-statistics/8-Simulation-based-inference-for-proportions-and-chi-square-testing/"><meta property="og:width" content="200"><meta property="og:height" content="200"><meta name=twitter:card content="summary"><meta name=twitter:title content="8 Simulation based inference for proportions and chi-square testing"><meta name=twitter:description content="#course_coursera-inferential-stats #statistics
Small sample proportions If the success-failure â‰¥ 10 rule (i.e. the Sample Size/Skew condition) is not satisfied, then the sampling distribution for your given scenario will not adhere to the CLT, reducing the effectiveness of CLT-based methods."><meta name=twitter:image content="https://wongd-hub.github.io/obsidian-quartz/icon.png"><title>8 Simulation based inference for proportions and chi-square testing</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://wongd-hub.github.io/obsidian-quartz//icon.png><link href=https://wongd-hub.github.io/obsidian-quartz/styles.19109a40042e9f0e72e952fda4442a34.min.css rel=stylesheet><link href=https://wongd-hub.github.io/obsidian-quartz/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://wongd-hub.github.io/obsidian-quartz/js/darkmode.df266a900377a99b203da11b154c20ec.min.js></script>
<script src=https://wongd-hub.github.io/obsidian-quartz/js/util.00639692264b21bc3ee219733d38a8be.min.js></script>
<link rel=preload href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css as=style onload='this.onload=null,this.rel="stylesheet"' integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/@floating-ui/core@1.2.1></script>
<script src=https://cdn.jsdelivr.net/npm/@floating-ui/dom@1.2.1></script>
<script defer src=https://wongd-hub.github.io/obsidian-quartz/js/popover.aa9bc99c7c38d3ae9538f218f1416adb.min.js></script>
<script defer src=https://wongd-hub.github.io/obsidian-quartz/js/code-title.ce4a43f09239a9efb48fee342e8ef2df.min.js></script>
<script defer src=https://wongd-hub.github.io/obsidian-quartz/js/clipboard.2913da76d3cb21c5deaa4bae7da38c9f.min.js></script>
<script defer src=https://wongd-hub.github.io/obsidian-quartz/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const SEARCH_ENABLED=!1,LATEX_ENABLED=!0,PRODUCTION=!0,BASE_URL="https://wongd-hub.github.io/obsidian-quartz/",fetchData=Promise.all([fetch("https://wongd-hub.github.io/obsidian-quartz/indices/linkIndex.283bf2cdb7011a99367b1133669542d5.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://wongd-hub.github.io/obsidian-quartz/indices/contentIndex.dfc40753b20c0b04624a92b0f5457756.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://wongd-hub.github.io/obsidian-quartz",!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://wongd-hub.github.io/obsidian-quartz",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}var i=document.getElementsByClassName("mermaid");i.length>0&&import("https://unpkg.com/mermaid@9/dist/mermaid.esm.min.mjs").then(e=>{e.default.init()});function a(n){const e=n.target,t=e.className.split(" "),s=t.includes("broken"),o=t.includes("internal-link");plausible("Link Click",{props:{href:e.href,broken:s,internal:o,graph:!1}})}const r=document.querySelectorAll("a");for(link of r)link.className.includes("root-title")&&link.addEventListener("click",a,{once:!0})},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'â€™':"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/wongd-hub.github.io\/obsidian-quartz\/js\/router.d6fe6bd821db9ea97f9aeefae814d8e7.min.js"
    attachSPARouting(init, render)
  </script><script defer data-domain=wongd-hub.github.io/obsidian-quartz src=https://plausible.io/js/script.js></script>
<script>window.plausible=window.plausible||function(){(window.plausible.q=window.plausible.q||[]).push(arguments)}</script></head><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://wongd-hub.github.io/obsidian-quartz/js/full-text-search.e6e2e0c213187ca0c703d6e2c7a77fcd.min.js></script><div class=singlePage><header><h1 id=page-title><a class=root-title href=https://wongd-hub.github.io/obsidian-quartz/>The Second ðŸ§ </a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>8 Simulation based inference for proportions and chi-square testing</h1><p class=meta>Last updated
Jul 31, 2023
<a href=https://github.com/wongd-hub/obsidian-quartz/tree/hugo/content/statistics/inferential-statistics/8%20Simulation%20based%20inference%20for%20proportions%20and%20chi-square%20testing.md rel=noopener>Edit Source</a></p><ul class=tags></ul><aside class=mainTOC><details><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#small-sample-proportions>Small sample proportions</a></li><li><a href=#examples>Examples</a></li><li><a href=#comparing-two-small-sample-proportions>Comparing two small sample proportions</a></li><li><a href=#chi-square-gof-test>Chi-Square GOF test</a></li></ol></nav></details></aside><p>#course_coursera-inferential-stats #statistics</p><a href=#small-sample-proportions><h2 id=small-sample-proportions><span class=hanchor arialabel=Anchor># </span>Small sample proportions</h2></a><p>If the success-failure â‰¥ 10 rule (i.e. the Sample Size/Skew condition) is not satisfied, then the sampling distribution for your given scenario will not adhere to the CLT, reducing the effectiveness of CLT-based methods.</p><p>Here, we turn to simulation-based methods such as bootstrapping.</p><p><strong>Example</strong></p><p>Paul the Octopus once picked the winner of all 8 World Cup games in a year correctly. The &rsquo;experiment&rsquo; design was to give Paul the choice of eating out of one box or another, where each box represented the flag of the competing teams that day.</p><p>Our hypothesis test will aim to determine whether Paul is psychic, or if he picked all games right just by chance.</p><p>$$H_0: p = 0.5, H_A: p > 0.5, n = 8, \hat{p} = 1$$</p><p>Checking to see if the conditions for CLT inference are met:</p><ul><li><p>Independence</p><ul><li>We can assume that Paul&rsquo;s picks each day are independent from each other for now</li></ul></li><li><p>Sample Size/Skew</p><ul><li>$0.5 imes 8 = 4$ which does not meet this condition.</li></ul></li></ul><p>Hence, CLT assumptions are not met and so CLT-based methods do not apply here. Instead, let&rsquo;s use simulation-based methods.</p><ul><li><p>The p-value for this hypothesis test is $P( ext{observed or more extreme outcome}\space|\space H_0 ext{ is true}) \Rightarrow P(\hat{p} \ge 1.0 \space|\space p = 0.5)$</p></li><li><p>So what we must do is devise a simulation scheme that can replicate Paul&rsquo;s trials, and perform these simulations under the assumption that the null hypothesis is true</p></li><li><p>Repeat this simulation N times, recording the relevant sample statistic each time</p></li><li><p>Calculate the p-value as the proportion of simulations that yielded sample statistics that were favourable to the alternative hypothesis</p></li></ul><p>To do this, we must simulate Paul&rsquo;s trials. Since he is picking between two boxes, with an assumed null probability of 50% chance for each box, we can approximate these trials by flipping a coin 8 times per simulation (flipping a coin is used as an example since it is conceptually equivalent to Paul&rsquo;s trial, no other significance here).</p><p>Below we:</p><ul><li><p>Flip a coin 8 times each simulation, naming &lsquo;heads&rsquo; a success and binding this to 1 (and tails to 0)</p></li><li><p>The proportion of heads in each 8 flips is then $\hat{p}_i$, for the $i$th simulation; we repeat this N = 100,000 times</p></li><li><p>These 100,000 $\hat{p}_i$s form the sampling/bootstrap distribution, see the histogram of results below</p></li><li><p>The p-value for this test will then be $P(\hat{p} \ge 1.0 \space|\space p = 0.5) \Rightarrow rac{ ext{num. simulations where }\hat{p} \ge 1}{N} pprox 0.00390$</p></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=nf>suppressPackageStartupMessages</span><span class=p>(</span><span class=nf>library</span><span class=p>(</span><span class=n>dplyr</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=nf>suppressPackageStartupMessages</span><span class=p>(</span><span class=nf>library</span><span class=p>(</span><span class=n>ggplot2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>options</span><span class=p>(</span><span class=n>repr.plot.width</span> <span class=o>=</span> <span class=m>15</span><span class=p>,</span> <span class=n>repr.plot.height</span> <span class=o>=</span> <span class=m>7</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>simulate_binary</span> <span class=o>&lt;-</span> <span class=nf>function</span><span class=p>(</span><span class=n>N</span><span class=p>,</span> <span class=n>n</span> <span class=o>=</span> <span class=m>8</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=n>results</span> <span class=o>&lt;-</span> <span class=nf>vector</span><span class=p>(</span><span class=s>&#39;double&#39;</span><span class=p>,</span> <span class=n>N</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl>	<span class=nf>sapply</span><span class=p>(</span>
</span></span><span class=line><span class=cl>		<span class=n>results</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nf>function</span><span class=p>(</span><span class=n>z</span><span class=p>)</span> <span class=nf>sample</span><span class=p>(</span><span class=nf>c</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=m>1</span><span class=p>),</span> <span class=n>n</span><span class=p>,</span> <span class=n>replace</span> <span class=o>=</span> <span class=bp>T</span><span class=p>)</span> <span class=o>|&gt;</span> <span class=nf>mean</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=p>)</span>
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>results</span> <span class=o>&lt;-</span> <span class=nf>simulate_binary</span><span class=p>(</span><span class=m>100000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>tibble</span><span class=p>(</span><span class=n>p_hat</span> <span class=o>=</span> <span class=n>results</span><span class=p>)</span> <span class=o>|</span>
</span></span><span class=line><span class=cl>	<span class=nf>ggplot</span><span class=p>(</span><span class=nf>aes</span><span class=p>(</span><span class=n>x</span> <span class=o>=</span> <span class=n>p_hat</span><span class=p>))</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>	<span class=nf>geom_histogram</span><span class=p>(</span><span class=n>bins</span> <span class=o>=</span> <span class=m>30</span><span class=p>)</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>	<span class=nf>labs</span><span class=p>(</span>
</span></span><span class=line><span class=cl>		<span class=n>title</span> <span class=o>=</span> <span class=s>&#39;Simulated p-hat for this experiment&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=n>y</span> <span class=o>=</span> <span class=s>&#39;Count&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=n>x</span> <span class=o>=</span> <span class=s>&#39;Simulated p-hat&#39;</span>
</span></span><span class=line><span class=cl>	<span class=p>)</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>	<span class=nf>scale_y_continuous</span><span class=p>(</span><span class=n>labels</span> <span class=o>=</span> <span class=n>scales</span><span class=o>::</span><span class=n>comma</span><span class=p>)</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>	<span class=nf>scale_x_continuous</span><span class=p>(</span><span class=n>labels</span> <span class=o>=</span> <span class=n>scales</span><span class=o>::</span><span class=n>percent</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><a class="internal-link broken">Pasted image 20230712230158.png</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=n>scales</span><span class=o>::</span><span class=nf>percent</span><span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=nf>Filter</span><span class=p>(</span><span class=nf>function</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=p>{</span><span class=n>x</span> <span class=o>&gt;=</span> <span class=m>1</span><span class=p>},</span> <span class=n>results</span><span class=p>)</span> <span class=o>|&gt;</span> <span class=nf>length</span><span class=p>()</span> <span class=o>/</span> <span class=nf>length</span><span class=p>(</span><span class=n>results</span><span class=p>),</span> 
</span></span><span class=line><span class=cl>		<span class=n>accuracy</span> <span class=o>=</span> <span class=m>0.001</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#&gt; &#39;0.390%&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>This is under the 5% significance level, hence we reject the null hypothesis as there is strong evidence for the alternative. Does this really mean that Paul is psychic? Probably not. We&rsquo;re likely making a Type I error here or possibly asking the wrong question.</p><a href=#examples><h2 id=examples><span class=hanchor arialabel=Anchor># </span>Examples</h2></a><p>Suppose we recruit 12 volunteers to test the validity of the idiom &ldquo;to know it like the back of one&rsquo;s hand&rdquo;. Each volunteer is shown 10 pictures of gloved hands and must correctly choose which picture contains their hand. Say 11 of 12 people complete this task successfully - is this sufficiently strong evidence that people truly know the backs of their hands?</p><p>$$H_0: ext{volunteers are no better than randomly guessing, ie }p = rac{1}{10}; H_A: p > rac{1}{10}$$</p><p>To devise a simulation scheme that is suitable for this experiment, we note that if the volunteers were truly randomly guessing then their true chance of picking their hand correctly is 0.1.</p><ul><li><p>We can roll a 10-sided fair die to represent the sampling space, calling &lsquo;1&rsquo; a success (recognising one&rsquo;s own hand) and all other outcomes a failure</p></li><li><p>For each simulation ($i$), we roll the die 12 times (to represent the 12 original volunteers), calculating $\hat{p}_i$ each time.</p></li><li><p>Run the simulation 100 times, creating a bootstrap distribution, then finding the proportion of simulations where the proportion is equal to or more extreme than the observed point estimate: $11/12 pprox 0.9167$.</p></li></ul><p>Performing this in a similar manner to the simulation demo shown previously, we get a p-value of very close to 0 and hence we reject the null hypothesis. There is strong evidence that the volunteers are better than just randomly guessing which of the 10 pictures was their own hand.</p><a href=#comparing-two-small-sample-proportions><h2 id=comparing-two-small-sample-proportions><span class=hanchor arialabel=Anchor># </span>Comparing two small sample proportions</h2></a><p>Suppose we extend the experiment we performed in the previous example to also test whether volunteers can recognise the palm side of their hands. We get the following results:</p><table><thead><tr><th style=text-align:left>Outcome</th><th style=text-align:right>Back</th><th style=text-align:right>Palm</th><th style=text-align:right>Total</th></tr></thead><tbody><tr><td style=text-align:left>Correct</td><td style=text-align:right>11</td><td style=text-align:right>7</td><td style=text-align:right>18</td></tr><tr><td style=text-align:left>Incorrect</td><td style=text-align:right>1</td><td style=text-align:right>5</td><td style=text-align:right>6</td></tr><tr><td style=text-align:left>Total</td><td style=text-align:right>12</td><td style=text-align:right>12</td><td style=text-align:right>24</td></tr><tr><td style=text-align:left>$\hat{p}$</td><td style=text-align:right>0.9167</td><td style=text-align:right>0.5833</td><td style=text-align:right>0.7500</td></tr></tbody></table><p>Do these data provide sufficient evidence that there is a difference in how good individuals are at recognising the backs of their hands vs. recognising the palm of their hands?</p><p>$H_0: p_{back} - p_{palm} = 0, H_A: p_{back} - p_{palm}
eq 0$</p><p>Checking assumptions</p><ul><li><p>Independence</p><ul><li>Within groups: we can assume that the guess of each volunteer is independent from the other volunteers&rsquo; guesses</li><li>Between groups: we have the same volunteers guessing across two tests - this is in fact a paired structure. For the purposes of illustration we will continue with this example though.</li></ul></li><li><p>Sample Size/Skew</p><ul><li>Since we&rsquo;re comparing between two population proportions here, we need to calculate number of successes and failures using the pooled proportion. $\hat{p}_{pool}$ is calculated in the table above as 0.75.</li><li>$12 imes 0.75 = 9$, and $12 imes 0.25 = 3$; neither of these meet the standard of 10, so CLT assumptions are not met - use simulation methods</li></ul></li></ul><p>Simulation scheme - the same principles as before apply, apart from the need to use the pooled proportion in this scheme</p><ul><li><p>Set up 24 index cards - each representing a volunteer and their two guesses across the two tests</p></li><li><p>Using the pooled proportion - mark 18 cards as &lsquo;correct&rsquo; and 6 cards as &lsquo;incorrect&rsquo;; note that this is done <em>before</em> apportioning the cards into the two groups</p></li><li><p>Apportion the 24 cards into two groups of 12 cards, representing back and palm tests</p></li><li><p>Calculate the difference in proportion between correctness in back and palm test groups. Resimulate many times, each difference in proportion is another entry in your bootstrap distribution</p></li></ul><p>Once your bootstrap distribution is constructed</p><ul><li><p>The point estimate of the difference is ~33% ($0.9167 - 0.5833$), so we want to find the proportion of simulations where $|\hat{p}| > 0.33$</p></li><li><p>This comes out to around 16%, so we would fail to reject the null hypothesis and we say there isn&rsquo;t strong evidence to suggest that there is a difference between people recognising the palm of their hand vs. the back of it.</p></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=n>simulate_mythbusters</span> <span class=o>&lt;-</span> <span class=nf>function</span><span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=n>N</span><span class=p>,</span> <span class=n>n</span> <span class=o>=</span> <span class=m>12</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>	<span class=n>sample_space</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=nf>rep</span><span class=p>(</span><span class=m>1</span><span class=p>,</span> <span class=m>18</span><span class=p>),</span> <span class=nf>rep</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=m>6</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=n>results</span> <span class=o>&lt;-</span> <span class=nf>vector</span><span class=p>(</span><span class=s>&#39;double&#39;</span><span class=p>,</span> <span class=n>N</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl>	<span class=nf>sapply</span><span class=p>(</span>
</span></span><span class=line><span class=cl>		<span class=n>results</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nf>function</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		
</span></span><span class=line><span class=cl>			<span class=n>idx</span> <span class=o>&lt;-</span> <span class=nf>sample</span><span class=p>(</span><span class=m>1</span><span class=o>:</span><span class=p>(</span><span class=m>2</span><span class=o>*</span><span class=n>n</span><span class=p>),</span> <span class=n>n</span><span class=p>,</span> <span class=n>replace</span> <span class=o>=</span> <span class=bp>F</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		
</span></span><span class=line><span class=cl>			<span class=n>p_hat_back</span> <span class=o>&lt;-</span> <span class=n>sample_space[idx]</span> <span class=o>|&gt;</span> <span class=nf>mean</span><span class=p>()</span>
</span></span><span class=line><span class=cl>			<span class=n>p_hat_palm</span> <span class=o>&lt;-</span> <span class=n>sample_space[</span><span class=o>-</span><span class=n>idx]</span> <span class=o>|&gt;</span> <span class=nf>mean</span><span class=p>()</span>
</span></span><span class=line><span class=cl>			
</span></span><span class=line><span class=cl>			<span class=n>p_hat_back</span> <span class=o>-</span> <span class=n>p_hat_palm</span>
</span></span><span class=line><span class=cl>		
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>results_mb</span> <span class=o>&lt;-</span> <span class=nf>simulate_mythbusters</span><span class=p>(</span><span class=m>100000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>tibble</span><span class=p>(</span><span class=n>p_hat_diff</span> <span class=o>=</span> <span class=n>results_mb</span><span class=p>)</span> <span class=o>|&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nf>ggplot</span><span class=p>(</span><span class=nf>aes</span><span class=p>(</span><span class=n>x</span> <span class=o>=</span> <span class=n>p_hat_diff</span><span class=p>))</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>	<span class=nf>geom_histogram</span><span class=p>(</span><span class=n>bins</span> <span class=o>=</span> <span class=m>30</span><span class=p>)</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>	<span class=nf>labs</span><span class=p>(</span>
</span></span><span class=line><span class=cl>		<span class=n>title</span> <span class=o>=</span> <span class=s>&#39;Simulated p-hat difference between back and palms for this experiment&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=n>y</span> <span class=o>=</span> <span class=s>&#39;Count&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=n>x</span> <span class=o>=</span> <span class=s>&#39;Simulated p-hat(back) - p-hat(palm)&#39;</span>
</span></span><span class=line><span class=cl>	<span class=p>)</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>	<span class=nf>scale_y_continuous</span><span class=p>(</span><span class=n>labels</span> <span class=o>=</span> <span class=n>scales</span><span class=o>::</span><span class=n>comma</span><span class=p>)</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>	<span class=nf>scale_x_continuous</span><span class=p>(</span><span class=n>labels</span> <span class=o>=</span> <span class=n>scales</span><span class=o>::</span><span class=n>percent</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><a class="internal-link broken">Pasted image 20230712230444.png</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=n>point_est_diff</span> <span class=o>&lt;-</span> <span class=m>0.9167</span> <span class=o>-</span> <span class=m>0.5833</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>scales</span><span class=o>::</span><span class=nf>percent</span><span class=p>(</span> 
</span></span><span class=line><span class=cl>	<span class=nf>Filter</span><span class=p>(</span><span class=nf>function</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=p>{</span><span class=nf>abs</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=n>point_est_diff</span><span class=p>},</span> <span class=n>results_mb</span><span class=p>)</span> <span class=o>|&gt;</span> <span class=nf>length</span><span class=p>()</span> <span class=o>/</span> <span class=nf>length</span><span class=p>(</span><span class=n>results_mb</span><span class=p>),</span> 
</span></span><span class=line><span class=cl>	<span class=n>accuracy</span> <span class=o>=</span> <span class=m>0.001</span> 
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#&gt; &#39;1.397%&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>This is below the significance level so we can say we have strong evidence for the alternative hypothesis that there is indeed a difference in people&rsquo;s ability to pick out the back of their hand vs. their palm.</p><p><em>Note: the course quotes a p-value of 15.66; unclear why this is so high and far off the value we get as they seem to do a substantial number of simulations as well</em></p><a href=#chi-square-gof-test><h2 id=chi-square-gof-test><span class=hanchor arialabel=Anchor># </span>Chi-Square GOF test</h2></a><p>Suppose the court of a small county is being accused of racial discrimination, with the claim being that the jury is not being picked in line with the ethnicity seen in the population of the county. See below the true proportion of each ethnicity within the county, as well as the number of individuals from each ethnicity seen in the jury. The expected row is the true population proportion multipled by 2500 which is the number of jurors picked.</p><table><thead><tr><th style=text-align:left>Population</th><th style=text-align:right>White</th><th style=text-align:right>Black</th><th style=text-align:right>Native American</th><th style=text-align:right>Asian</th><th style=text-align:right>Other</th><th style=text-align:right>Total</th></tr></thead><tbody><tr><td style=text-align:left>Census</td><td style=text-align:right>80.29%</td><td style=text-align:right>12.06%</td><td style=text-align:right>0.79%</td><td style=text-align:right>2.92%</td><td style=text-align:right>3.94%</td><td style=text-align:right>100%</td></tr><tr><td style=text-align:left>Jury</td><td style=text-align:right>1920</td><td style=text-align:right>347</td><td style=text-align:right>19</td><td style=text-align:right>84</td><td style=text-align:right>130</td><td style=text-align:right>100%</td></tr><tr><td style=text-align:left># Expected</td><td style=text-align:right>2007</td><td style=text-align:right>302</td><td style=text-align:right>20</td><td style=text-align:right>73</td><td style=text-align:right>98</td><td style=text-align:right>2500</td></tr></tbody></table><p>Based on hypothesis testing principles, our null hypothesis would be that there is nothing going on (i.e. the distribution of jurors matches the distribution of the population); whereas our alternative hypothesis would be that the distributions are not the same.</p><p>Here we want to be able to quantify how different the observed counts are from the expected counts, large differences from the expected counts provide evidence to the alternative hypothesis</p><ul><li>This is called a goodness-of-fit (GOF) test since we&rsquo;re evaluating how well the observed distribution <em>fits</em> to the expected distribution.</li><li>The name of this test is the Chi-Square ($</li></ul></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li>No backlinks found</li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://wongd-hub.github.io/obsidian-quartz/js/graph.6579af7b10c818dbd2ca038702db0224.js></script></div></div><div id=contact_buttons><footer><p>Made by Darren Wong using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, Â© 2023</p><ul><li><a href=https://wongd-hub.github.io/obsidian-quartz/>Home</a></li><li><a href=https://www.herdmentality.xyz/>Herd Mentality (Blog)</a></li><li><a href=https://github.com/wongd-hub>GitHub</a></li></ul></footer></div></div></body></html>